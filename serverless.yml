service: mymangalist
frameworkVersion: '2'
useDotenv: true

plugins:
  - serverless-python-requirements
  - serverless-offline

custom:
  pythonRequirements: # DO NOT REMOVE THIS, THIS HELP US TO AVOID PYTHON VERSION ERRORS
    pythonBin: python3

provider:
  name: aws
  runtime: python3.8
  lambdaHashingVersion: 20201221
  stage: ${opt:stage, 'dev'}
  region: us-east-1
  logRetentionInDays: 5
  deploymentBucket: my-serverless-bucket-deployment
  tags:
    project: ${self:service}
  iam:
    role:
      statements:
        - Effect: Allow
          Action:
            - s3:*
            - cloudwatch:*
            - dynamodb:*
          Resource: "*"
  environment:
    DYNAMODB_MANGAS_TABLE_NAME: ${self:service}_${self:provider.stage}_mangas

functions:
  - ${file(src/functions/create-new-manga/function.yml)}

resources:
  - ${file(resources/api-gateway.yml)}
